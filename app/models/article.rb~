class Article < ActiveRecord::Base
  belongs_to :author
  belongs_to :category
  has_many :comments
  
  acts_as_ferret :fields => [:title, :body]
  
  validates_presence_of :title, :body
  
  define_index do
    indexes body
    indexes title
  end

  def popularity
    views*1 + comments.size*1
  end
  
  def self.next(article)
    if article == Article.last
      article
    else
      Article.find((params[:id].to_i+1).to_s)
    end
  end
  
  def self.prev(article)
    if article == Article.first
      article
    else
      Article.find((params[:id].to_i-1).to_s)
    end
  end
  
end
